#!/usr/bin/env node
const fs = require('fs');
const puppeteer = require('puppeteer');

const args = process.argv.slice(2);

const options = {
    url: null,
    filepath: null,
    pdfMarginTop: 0,
    pdfMarginLeft: 0,
    pdfMarginRight: 0,
    pdfMarginBottom: 0,
    pdfOutputPath: null,
    pdfFormat: 'A4',
    pdfLandscape: false,
    pdfDisplayHeaderFooter: false,
    pdfHeaderTemplate: null,
    pdfFooterTemplate: null,
};

args.forEach(argument => mapArgToOptions(argument));

function mapArgToOptions(argument) {
    const split = argument.split('=');
    split[0] = split[0].slice(2);
    options[split[0]] = split[1];
}

(async () => {
    const fileExists = fs.existsSync(options.filepath);

    if (!fileExists) {
        throw new Error('File does not exists');
    }

    const browser = await puppeteer.launch({headless: true});

    const page = await browser.newPage();
    await page.emulateMediaType('screen');
    await page.goto('file://' + options.filepath);

    const headerTemplate = `
        <style>
            #header { padding: 0 !important; font-family: sans-serif }
            * { box-sizing: border-box; }
            table { width: 100%; margin: 2.5mm 15mm 0; }
        </style>
        <table><tr>
        <td>
            <img style="width: 40mm; float: left;" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjxzdmcKICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIgogICB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIgogICB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiCiAgIHhtbG5zOnN2Zz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgeG1sbnM6c29kaXBvZGk9Imh0dHA6Ly9zb2RpcG9kaS5zb3VyY2Vmb3JnZS5uZXQvRFREL3NvZGlwb2RpLTAuZHRkIgogICB4bWxuczppbmtzY2FwZT0iaHR0cDovL3d3dy5pbmtzY2FwZS5vcmcvbmFtZXNwYWNlcy9pbmtzY2FwZSIKICAgaWQ9IkNhbHF1ZV8xIgogICBkYXRhLW5hbWU9IkNhbHF1ZSAxIgogICB2aWV3Qm94PSIwIDAgMjA0LjY3IDcyLjU1MDAwMyIKICAgdmVyc2lvbj0iMS4xIgogICBzb2RpcG9kaTpkb2NuYW1lPSJLZWxpcHMtbG9nby5zdmciCiAgIHdpZHRoPSIyMDQuNjciCiAgIGhlaWdodD0iNzIuNTUwMDAzIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjkyLjEgcjE1MzcxIj4KICA8bWV0YWRhdGEKICAgICBpZD0ibWV0YWRhdGEzODI2Ij4KICAgIDxyZGY6UkRGPgogICAgICA8Y2M6V29yawogICAgICAgICByZGY6YWJvdXQ9IiI+CiAgICAgICAgPGRjOmZvcm1hdD5pbWFnZS9zdmcreG1sPC9kYzpmb3JtYXQ+CiAgICAgICAgPGRjOnR5cGUKICAgICAgICAgICByZGY6cmVzb3VyY2U9Imh0dHA6Ly9wdXJsLm9yZy9kYy9kY21pdHlwZS9TdGlsbEltYWdlIiAvPgogICAgICAgIDxkYzp0aXRsZT5LZWxpcHMtbG9nbzwvZGM6dGl0bGU+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxkZWZzCiAgICAgaWQ9ImRlZnMzODI0IiAvPgogIDxzb2RpcG9kaTpuYW1lZHZpZXcKICAgICBwYWdlY29sb3I9IiNmZmZmZmYiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMSIKICAgICBvYmplY3R0b2xlcmFuY2U9IjEwIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwIgogICAgIGd1aWRldG9sZXJhbmNlPSIxMCIKICAgICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTkyMCIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSIxMDE2IgogICAgIGlkPSJuYW1lZHZpZXczODIyIgogICAgIHNob3dncmlkPSJmYWxzZSIKICAgICBmaXQtbWFyZ2luLXRvcD0iNi4zODM3ODI0ZS0xNiIKICAgICBmaXQtbWFyZ2luLWxlZnQ9IjAiCiAgICAgZml0LW1hcmdpbi1yaWdodD0iMCIKICAgICBmaXQtbWFyZ2luLWJvdHRvbT0iMCIKICAgICBpbmtzY2FwZTp6b29tPSI3LjIwODMzMzMiCiAgICAgaW5rc2NhcGU6Y3g9IjExOS4xNDc0IgogICAgIGlua3NjYXBlOmN5PSIzMS43NzA4NjciCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjAiCiAgICAgaW5rc2NhcGU6d2luZG93LXk9IjI3IgogICAgIGlua3NjYXBlOndpbmRvdy1tYXhpbWl6ZWQ9IjEiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0iQ2FscXVlXzEiIC8+CiAgPHRpdGxlCiAgICAgaWQ9InRpdGxlMzc3MyI+S2VsaXBzLWxvZ288L3RpdGxlPgogIDxwb2x5bGluZQogICAgIHBvaW50cz0iMTcuNSA1Ny4yMiAzNi4zNSAyNi44IDUwLjc3IDM2IgogICAgIGlkPSJwb2x5bGluZTM3NzUiCiAgICAgc3R5bGU9Im9wYWNpdHk6MC4xODAwMDAwNDtmaWxsOiNmNzAwMDQiCiAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTE3LjUsLTE0Ljc3KSIgLz4KICA8cG9seWxpbmUKICAgICBwb2ludHM9IjM1Ljg4IDQ1LjQ3IDE3LjUgMTQuNzcgNTAuNzcgMzUuOTkiCiAgICAgaWQ9InBvbHlsaW5lMzc3NyIKICAgICBzdHlsZT0ib3BhY2l0eTowLjM3MDAwMDAyO2ZpbGw6I2Y3MDAwNCIKICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTcuNSwtMTQuNzcpIiAvPgogIDxwb2x5Z29uCiAgICAgcG9pbnRzPSIxNy41LDE0Ljc3IDUwLjc3LDM1Ljk5IDQyLjQyLDQxLjMyICIKICAgICBpZD0icG9seWdvbjM3NzkiCiAgICAgc3R5bGU9Im9wYWNpdHk6MC41Mjk5OTk5ODtmaWxsOiNmNzAwMDQiCiAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTE3LjUsLTE0Ljc3KSIgLz4KICA8cG9seWdvbgogICAgIHBvaW50cz0iMTcuNSw1Ny4yMiA0Mi40MiwzMC42OCA1MC43NywzNiAiCiAgICAgaWQ9InBvbHlnb24zNzgxIgogICAgIHN0eWxlPSJvcGFjaXR5OjAuNDIwMDAwMDI7ZmlsbDojZjcwMDA0IgogICAgIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xNy41LC0xNC43NykiIC8+CiAgPHBvbHlsaW5lCiAgICAgcG9pbnRzPSI1MC43NyA4Ny4zMiAzMS45MiA1Ni45IDE3LjUgNjYuMSIKICAgICBpZD0icG9seWxpbmUzNzgzIgogICAgIHN0eWxlPSJvcGFjaXR5OjAuNDIwMDAwMDI7ZmlsbDojMDA4ZDM2IgogICAgIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xNy41LC0xNC43NykiIC8+CiAgPHBvbHlsaW5lCiAgICAgcG9pbnRzPSIzMi4zOSA3NS41NyA1MC43NyA0NC44NyAxNy41IDY2LjA5IgogICAgIGlkPSJwb2x5bGluZTM3ODUiCiAgICAgc3R5bGU9Im9wYWNpdHk6MC40MjAwMDAwMjtmaWxsOiMwMDhkMzYiCiAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTE3LjUsLTE0Ljc3KSIgLz4KICA8cG9seWdvbgogICAgIHBvaW50cz0iNTAuNzcsNDQuODcgMTcuNSw2Ni4wOSAyNS44NSw3MS40MiAiCiAgICAgaWQ9InBvbHlnb24zNzg3IgogICAgIHN0eWxlPSJvcGFjaXR5OjAuNDIwMDAwMDI7ZmlsbDojMDA4ZDM2IgogICAgIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xNy41LC0xNC43NykiIC8+CiAgPHBvbHlnb24KICAgICBwb2ludHM9IjUwLjc3LDg3LjMyIDI1Ljg1LDYwLjc3IDE3LjUsNjYuMSAiCiAgICAgaWQ9InBvbHlnb24zNzg5IgogICAgIHN0eWxlPSJvcGFjaXR5OjAuNDIwMDAwMDI7ZmlsbDojMDA4ZDM2IgogICAgIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xNy41LC0xNC43NykiIC8+CiAgPHBhdGgKICAgICBkPSJNIDcyLjI0LDE2LjMgNjAuNzIsMjguNzEgNzMuMiw0MS43OCB2IDAuMyBoIC02IEwgNTYuMzEsMzAuNiBWIDQyLjA4IEggNTEuNDIgViAxNi4xNSBoIDQuODkgdiAxMSBsIDkuODYsLTExIGggNi4wNyB6IgogICAgIGlkPSJwYXRoMzc5MSIKICAgICBpbmtzY2FwZTpjb25uZWN0b3ItY3VydmF0dXJlPSIwIiAvPgogIDxwYXRoCiAgICAgZD0iTSAxMDAuODIsNDIuMDggSCA4MS40MSBWIDE2LjE1IGggMTkuNDEgdiA0Ljc0IEggODYuMjYgdiA2IGggMTQgdiA0LjU1IGggLTE0IHYgNS43OSBoIDE0LjU2IHoiCiAgICAgaWQ9InBhdGgzNzkzIgogICAgIGlua3NjYXBlOmNvbm5lY3Rvci1jdXJ2YXR1cmU9IjAiIC8+CiAgPHBhdGgKICAgICBkPSJtIDExNS4yOCwxNi4xNSB2IDIxLjQxIGggMTMuMzMgdiA0LjUyIEggMTEwLjM5IFYgMTYuMTUgWiIKICAgICBpZD0icGF0aDM3OTUiCiAgICAgaW5rc2NhcGU6Y29ubmVjdG9yLWN1cnZhdHVyZT0iMCIgLz4KICA8cGF0aAogICAgIGQ9Ik0gMTM3Ljg5LDQyLjA4IFYgMTYuMTUgaCA0Ljg2IHYgMjUuOTMgeiIKICAgICBpZD0icGF0aDM3OTciCiAgICAgaW5rc2NhcGU6Y29ubmVjdG9yLWN1cnZhdHVyZT0iMCIgLz4KICA8cGF0aAogICAgIGQ9Im0gMTY1LjM1LDM0LjQ1IGggLTcuMzMgdiA3LjYzIGggLTQuODkgViAxNi4xNSBjIDQuMDcsMCA4LjE0LDAgMTIuMjIsMCAxMi42NywtMC4wNCAxMi43LDE4LjMgMCwxOC4zIHogbSAtNy4zMywtNC40OCBoIDcuMzMgYyA2LjI2LDAgNi4yMywtOS4xOSAwLC05LjE5IGggLTcuMzMgeiIKICAgICBpZD0icGF0aDM3OTkiCiAgICAgaW5rc2NhcGU6Y29ubmVjdG9yLWN1cnZhdHVyZT0iMCIgLz4KICA8cGF0aAogICAgIGQ9Im0gMTk5Ljk2LDIyLjQxIGMgLTAuODksLTEuNDggLTMuMzMsLTIuODkgLTYuMTUsLTIuODkgLTMuNjMsMCAtNS4zNywxLjUyIC01LjM3LDMuNDUgMCwyLjI1IDIuNjcsMi44OSA1Ljc4LDMuMjYgNS40MSwwLjY2IDEwLjQ1LDIuMDcgMTAuNDUsOC4yNiAwLDUuNzggLTUuMTIsOC4yNiAtMTAuODksOC4yNiAtNS4zLDAgLTkuMzgsLTEuNjMgLTExLjMsLTYuMzcgbCA0LjA3LC0yLjE1IGMgMS4xNSwyLjg2IDQuMTUsNC4xMiA3LjMsNC4xMiAzLjE1LDAgNiwtMS4wOCA2LC0zLjg5IDAsLTIuNDUgLTIuNTUsLTMuNDUgLTYsLTMuODIgLTUuMywtMC42MyAtMTAuMTgsLTIgLTEwLjE4LC03Ljg1IDAsLTUuMzQgNS4yNiwtNy41MiAxMCwtNy41NiA0LDAgOC4yMywxLjE1IDEwLjE5LDUuMTUgeiIKICAgICBpZD0icGF0aDM4MDEiCiAgICAgaW5rc2NhcGU6Y29ubmVjdG9yLWN1cnZhdHVyZT0iMCIgLz4KICA8cGF0aAogICAgIGQ9Im0gNTMuNjgsNDkuMjMgaCAwLjk1IGwgNC4yNSw5LjUzIEggNTcuNSBsIC0xLjI2LC0yLjgxIGggLTQgTCA1MSw1OC43NiBoIC0xLjM5IHogbSAyLDUuNTEgLTEuNTMsLTMuNDMgLTEuNDIsMy40MyB6IgogICAgIGlkPSJwYXRoMzgwMyIKICAgICBpbmtzY2FwZTpjb25uZWN0b3ItY3VydmF0dXJlPSIwIgogICAgIHN0eWxlPSJmaWxsOiMwMDhkMzYiIC8+CiAgPHBhdGgKICAgICBkPSJtIDcxLjkyLDU0Ljc5IC0xLC0wLjYzIEEgNC43LDQuNyAwIDAgMSA2OS41LDUzIGEgMi4yLDIuMiAwIDAgMSAtMC40MiwtMS4zMyAyLjMxLDIuMzEgMCAwIDEgMC43OCwtMS44MSAyLjg5LDIuODkgMCAwIDEgMiwtMC43IDMuODYsMy44NiAwIDAgMSAyLjE4LDAuNjYgdiAxLjU1IGEgMy4xNSwzLjE1IDAgMCAwIC0yLjIxLC0xIDEuOCwxLjggMCAwIDAgLTEuMDksMC4zMSAwLjkzLDAuOTMgMCAwIDAgLTAuNDMsMC43OSAxLjIxLDEuMjEgMCAwIDAgMC4zMiwwLjc5IDMuOTMsMy45MyAwIDAgMCAxLDAuNzggbCAxLDAuNjEgYSAzLjA2LDMuMDYgMCAwIDEgMS43MywyLjY0IDIuNDQsMi40NCAwIDAgMSAtMC43NiwxLjg2IDIuODIsMi44MiAwIDAgMSAtMiwwLjcxIDQuMTIsNC4xMiAwIDAgMSAtMi41NSwtMC44NyB2IC0xLjcxIGEgMy4xNywzLjE3IDAgMCAwIDIuNTQsMS4zOSAxLjU4LDEuNTggMCAwIDAgMS4wNiwtMC4zNSAxLjEsMS4xIDAgMCAwIDAuNDMsLTAuODkgYyAwLjA5LC0wLjU4IC0wLjMzLC0xLjEyIC0xLjE2LC0xLjY0IHoiCiAgICAgaWQ9InBhdGgzODA1IgogICAgIGlua3NjYXBlOmNvbm5lY3Rvci1jdXJ2YXR1cmU9IjAiCiAgICAgc3R5bGU9ImZpbGw6IzAwOGQzNiIgLz4KICA8cGF0aAogICAgIGQ9Im0gODcuOTMsNTQuNzkgLTEsLTAuNjMgQSA0LjcsNC43IDAgMCAxIDg1LjUsNTMgYSAyLjE5LDIuMTkgMCAwIDEgLTAuNDEsLTEuMzMgMi4zLDIuMyAwIDAgMSAwLjc3LC0xLjgxIDIuODksMi44OSAwIDAgMSAyLC0wLjcgMy44NiwzLjg2IDAgMCAxIDIuMTgsMC42NiB2IDEuNTUgYSAzLjEzLDMuMTMgMCAwIDAgLTIuMiwtMSAxLjgxLDEuODEgMCAwIDAgLTEuMSwwLjMxIDAuOTIsMC45MiAwIDAgMCAtMC40MiwwLjc5IDEuMiwxLjIgMCAwIDAgMC4zMSwwLjc5IDMuOTMsMy45MyAwIDAgMCAxLDAuNzggbCAxLDAuNjEgYSAzLjA2LDMuMDYgMCAwIDEgMS44NywyLjY1IDIuNDQsMi40NCAwIDAgMSAtMC43NiwxLjg2IDIuODIsMi44MiAwIDAgMSAtMiwwLjcxIEEgNC4xNCw0LjE0IDAgMCAxIDg1LjE5LDU4IHYgLTEuNzIgYSAzLjE4LDMuMTggMCAwIDAgMi41NCwxLjM5IDEuNTYsMS41NiAwIDAgMCAxLjA2LC0wLjM1IDEuMSwxLjEgMCAwIDAgMC40MywtMC44OSBjIC0wLjA0LC0wLjU4IC0wLjQ2LC0xLjEyIC0xLjI5LC0xLjY0IHoiCiAgICAgaWQ9InBhdGgzODA3IgogICAgIGlua3NjYXBlOmNvbm5lY3Rvci1jdXJ2YXR1cmU9IjAiCiAgICAgc3R5bGU9ImZpbGw6IzAwOGQzNiIgLz4KICA8cGF0aAogICAgIGQ9Im0gMTA4LjE5LDQ5LjI4IGggMS4zNiB2IDUuMzggYSA2LjIyLDYuMjIgMCAwIDEgLTAuMTYsMS42NSAzLjE0LDMuMTQgMCAwIDEgLTAuMzksMC45MiAyLjgxLDIuODEgMCAwIDEgLTAuNTcsMC42NyA1LDUgMCAwIDEgLTUuOTIsMCAyLjYsMi42IDAgMCAxIC0wLjU3LC0wLjY3IDMuMTMsMy4xMyAwIDAgMSAtMC4zOSwtMC45IDYuODMsNi44MyAwIDAgMSAtMC4xNSwtMS42OCB2IC01LjM3IGggMS4zNiB2IDUuMzggYSA0LjA3LDQuMDcgMCAwIDAgMC4zLDEuODYgMi4yMSwyLjIxIDAgMCAwIDAuOTQsMC44NCAzLjE5LDMuMTkgMCAwIDAgMS40NywwLjMxIDIuOSwyLjkgMCAwIDAgMiwtMC42MyAxLjgyLDEuODIgMCAwIDAgMC41OCwtMC44IDQuNzgsNC43OCAwIDAgMCAwLjE4LC0xLjU4IHoiCiAgICAgaWQ9InBhdGgzODA5IgogICAgIGlua3NjYXBlOmNvbm5lY3Rvci1jdXJ2YXR1cmU9IjAiCiAgICAgc3R5bGU9ImZpbGw6IzAwOGQzNiIgLz4KICA8cGF0aAogICAgIGQ9Im0gMTIxLjEyLDU4Ljc2IHYgLTkuNDggaCAyLjM4IGEgMy40NywzLjQ3IDAgMCAxIDIuMjgsMC43MSAyLjQ5LDIuNDkgMCAwIDEgLTAuNzYsNC4yNiA0LjE4LDQuMTggMCAwIDEgMC44OSwwLjgyIDE1LDE1IDAgMCAxIDEuMjIsMS44IGMgMC4zMywwLjU0IDAuNiwwLjk0IDAuNzksMS4yMSBsIDAuNTEsMC42OCBoIC0xLjYyIGwgLTAuNDEsLTAuNjMgLTAuMDgsLTAuMTEgLTAuMjYsLTAuMzcgLTAuNDIsLTAuNyAtMC40NiwtMC43NCBhIDguNDQsOC40NCAwIDAgMCAtMC43NywtMC45MyAyLjcxLDIuNzEgMCAwIDAgLTAuNjMsLTAuNDkgMiwyIDAgMCAwIC0wLjk1LC0wLjE2IGggLTAuMzMgdiA0LjEzIHogbSAxLjc2LC04LjMzIGggLTAuMzggdiAzIGggMC41MSBhIDMuOCwzLjggMCAwIDAgMS40MiwtMC4xOCAxLjQyLDEuNDIgMCAwIDAgMC42LC0wLjU0IDEuNTMsMS41MyAwIDAgMCAwLjIxLC0wLjgxIDEuNDcsMS40NyAwIDAgMCAtMC4yNCwtMC44MSAxLjMzLDEuMzMgMCAwIDAgLTAuNjcsLTAuNTEgNC44LDQuOCAwIDAgMCAtMS40NSwtMC4xNSB6IgogICAgIGlkPSJwYXRoMzgxMSIKICAgICBpbmtzY2FwZTpjb25uZWN0b3ItY3VydmF0dXJlPSIwIgogICAgIHN0eWxlPSJmaWxsOiMwMDhkMzYiIC8+CiAgPHBhdGgKICAgICBkPSJtIDE0Mi4xNCw0OS4yMyBoIDEgbCA0LjI1LDkuNTMgSCAxNDYgbCAtMS4yNiwtMi44MSBoIC00IGwgLTEuMjQsMi44MSBoIC0xLjQgeiBtIDIsNS41MSAtMS41MywtMy40MyAtMS40MiwzLjQzIHoiCiAgICAgaWQ9InBhdGgzODEzIgogICAgIGlua3NjYXBlOmNvbm5lY3Rvci1jdXJ2YXR1cmU9IjAiCiAgICAgc3R5bGU9ImZpbGw6IzAwOGQzNiIgLz4KICA8cGF0aAogICAgIGQ9Im0gMTY1LjU3LDQ5LjI4IGggMS4yOSB2IDkuNDggaCAtMS4xNyBsIC02LjM0LC03LjMgdiA3LjMgaCAtMS4yOCB2IC05LjQ4IGggMS4xIGwgNi40LDcuMzYgeiIKICAgICBpZD0icGF0aDM4MTUiCiAgICAgaW5rc2NhcGU6Y29ubmVjdG9yLWN1cnZhdHVyZT0iMCIKICAgICBzdHlsZT0iZmlsbDojMDA4ZDM2IiAvPgogIDxwYXRoCiAgICAgZD0ibSAxODYuNzEsNTYuNTYgdiAxLjQ5IGEgNyw3IDAgMCAxIC0zLjQ1LDAuODIgNS4yMyw1LjIzIDAgMCAxIC0yLjY5LC0wLjY0IDQuNjUsNC42NSAwIDAgMSAtMS43NiwtMS43NiA0Ljc0LDQuNzQgMCAwIDEgLTAuNjQsLTIuNDIgNC42Myw0LjYzIDAgMCAxIDEuNDcsLTMuNDggNS4wOCw1LjA4IDAgMCAxIDMuNjQsLTEuNDEgOC41NCw4LjU0IDAgMCAxIDMuMzIsMC43OCB2IDEuNDYgYSA2LjQ2LDYuNDYgMCAwIDAgLTMuMjUsLTEgMy43NCwzLjc0IDAgMCAwIC0yLjcsMSAzLjM5LDMuMzkgMCAwIDAgLTEuMDgsMi41NyAzLjM0LDMuMzQgMCAwIDAgMS4wNiwyLjU2IDMuNzcsMy43NyAwIDAgMCAyLjcxLDEgNi4xMyw2LjEzIDAgMCAwIDMuMzcsLTAuOTcgeiIKICAgICBpZD0icGF0aDM4MTciCiAgICAgaW5rc2NhcGU6Y29ubmVjdG9yLWN1cnZhdHVyZT0iMCIKICAgICBzdHlsZT0iZmlsbDojMDA4ZDM2IiAvPgogIDxwYXRoCiAgICAgZD0ibSAxOTguMDIsNDkuMjggaCA1LjM4IHYgMS4yMSBoIC00IHYgMi44OSBoIDMuODggdiAxLjIxIGggLTMuODggdiAzIGggNC4xIHYgMS4yMSBoIC01LjUxIHoiCiAgICAgaWQ9InBhdGgzODE5IgogICAgIGlua3NjYXBlOmNvbm5lY3Rvci1jdXJ2YXR1cmU9IjAiCiAgICAgc3R5bGU9ImZpbGw6IzAwOGQzNiIgLz4KPC9zdmc+Cg==">        
        </td>
        <td>
            <p style="font-size: 5pt; text-align: right"><span class="date"></span></p>        
        </td>
        </tr></table>
    `;
    const footerTemplate = `<p style="width: 100%; font-size: 6pt; text-align: right; padding: 0 10mm"><span class="pageNumber"></span> / <span class="totalPages"></span></p>`;

    await page.waitForTimeout(1000);
    const pdfOptions = {
        path: options.pdfOutputPath,
        format: options.pdfFormat,
        landscape: options.pdfLandscape === 'true' || options.pdfLandscape,
        displayHeaderFooter: options.pdfDisplayHeaderFooter === 'true' || options.pdfDisplayHeaderFooter,
        margin: {
            top: options.pdfMarginTop,
            left: options.pdfMarginLeft,
            right: options.pdfMarginRight,
            bottom: options.pdfMarginBottom,
        }
    };

    if (pdfOptions.displayHeaderFooter) {
        pdfOptions.headerTemplate = headerTemplate;
        pdfOptions.footerTemplate = footerTemplate;
    }

    await page.pdf(pdfOptions);

    await browser.close();
})();
